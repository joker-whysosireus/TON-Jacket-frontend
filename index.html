<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TON Mania</title>
    
    <link rel="stylesheet" href="index.css">
    
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js?56"></script>
    
    <!-- GigaPub Script -->
    <script data-project-id="3563">
        !function(){
            var s=document.currentScript,p=s.getAttribute('data-project-id')||'default';
            var d=['https://ad.gigapub.tech','https://ru-ad.gigapub.tech'],i=0,t,sc;
            function l(){
                sc=document.createElement('script');
                sc.async=true;
                sc.src=d[i]+'/script?id='+p;
                clearTimeout(t);
                t=setTimeout(function(){
                    sc.onload=sc.onerror=null;
                    sc.src='';
                    if(++i<d.length)l();
                },15000);
                
                sc.onload=function(){
                    clearTimeout(t);
                    console.log("GigaPub SDK загружен успешно");
                    
                    // Создаем функцию showGiga после загрузки SDK
                    if (window.gigaOfferWallSDK) {
                        window.gigaOfferWallSDK.init({
                            projectId: "3563"
                        });
                        
                        window.showGiga = function() {
                            return new Promise((resolve, reject) => {
                                if (window.gigaOfferWallSDK && typeof window.gigaOfferWallSDK.open === 'function') {
                                    // Добавляем обработчик закрытия
                                    window.gigaOfferWallSDK.open({
                                        onClose: function() {
                                            console.log("GigaPub OfferWall закрыт");
                                            resolve();
                                        },
                                        onError: function(error) {
                                            console.error("GigaPub OfferWall ошибка:", error);
                                            reject(new Error(error));
                                        }
                                    });
                                    console.log("GigaPub OfferWall открыт");
                                } else {
                                    const error = "GigaPub SDK недоступен";
                                    console.error(error);
                                    reject(new Error(error));
                                }
                            });
                        };
                        console.log("GigaPub функция showGiga инициализирована");
                    } else {
                        console.error("GigaPub SDK не найден после загрузки");
                    }
                };
                
                sc.onerror=function(){
                    clearTimeout(t);
                    console.error("Ошибка загрузки GigaPub с", d[i]);
                    if(++i<d.length)l();
                };
                document.head.appendChild(sc);
            }
            l();
        }();
    </script>
</head>
<body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
</body>
</html>
